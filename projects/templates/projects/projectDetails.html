{%extends 'base.html'%} {%block body%}

{% if messages %}
<div class="messages">
    {% for message in messages %}
    <div{% if message.tags %} class="{{ message.tags }} alert alert-danger"{% endif %}>{{ message }}</div>
    {% endfor %}
</div>
{% endif %}

{% comment %} <div class="container bg-dark text-light rounded shadow shadow-lg my-3 p-3">




 <h3> Rate Project </h3>
  <form method="post" class="form-group">
    {% csrf_token %}
    {{ratingForm}}
    <div class='d-flex justify-content-end me-2 '>
    <input type="submit" name="submit-rating" value="Submit Rating" class="btn btn-primary mt-2 px-3 py-2">
    </div>
  </form>


</div>
<div class='border p-3  shadow shadow-lg rounded'>

<h2 class='mb-3'>Give us your opinion </h2>
<form method="post" class="form-group">
  {% csrf_token %}
 <textarea name="text" id="commentText" class="form-control" required></textarea>
 <div class="d-flex justify-content-end ">
  <input type="submit" name="submit-comment" value="Submit Comment" class="btn btn-primary ms-2 px-4 my-3 ">
</div></form>

{%if currentProject.comments.all %}
<div class='p-3'>
<h2>Comments </h2>
{% for comment in currentProject.comments.all %}
  <div class='form-control shadow shadow-lg pt-3 my-3'>
    <div class='d-flex justify-content-between'>
   <p>{{ comment.user.user.username }} : </p>
  <a href='{%url "reportComment" id=currentProject.id commentID=comment.id %}'><button type'button' class='btn btn-danger'>Report Comment</button></a>
    </div>
  <p>{{ comment.text }}</p>
  </div>
  {% endfor %}
</div>
  {%endif%}
</div> {% endcomment %}

<div class="container mt-4">
  <div class="row">
      <div class="col-md-8">
          <h1>{{ currentProject.title }}</h1>
          <p>By: Project Creator</p>
          <img src="{{currentProject.images.first.image.url}}" alt="Project Image" class="img-fluid">
          <h3>Project Description:</h3>
          <p>{{ currentProject.details }}</p>
          <h3>Categories:</h3>
          {% for category in currentProject.category.all %}
            <p>{{ category.name }}</p>
          {% endfor %}
          <h3>Tags:</h3>
          {% for tag in currentProject.tags.all %}
            <p>{{ tag.name }}</p>
          {% endfor %}
          <h3>Total target: {{ currentProject.target }}$</h3>
          <h3>Start Date: {{ currentProject.start_time }}</h3>
          <h3>End Date: {{ currentProject.end_time }}</h3>
          <h3>Donations:
            {% for donation in currentProject.donations.all %}
                <p style="color: red">User: {{ donation.user.user.username }} Donated, Amount: {{ donation.donation }}</p>
            {% endfor %}
          </h3>
          <h3>Ratings:</h3>
          {% for rating in currentProject.ratings.all %}
          <p>{{ rating.user.user.username }} || {{ rating.rating }}</p>
            {% endfor %}
          <p>Average Rating: {{ averageRating }}</p>

      </div>
      <div class="col-md-4">
          <div class="row">
              <div class="col-md-12">
                  <div class="card">
                      <div class="card-body">
                          <h5 class="card-title">Support this Project</h5>
                          <form method="post" class="form-group">
                            {% csrf_token %}
                            {% if not currentProject.completed %}
                              <input type="number" name="donation" class="form-control" min="1" required>
                              <div class='d-flex justify-content-end me-2 '>
                                <input type="submit" name="submit-donation" value="Donate" class="btn btn-primary mt-2 px-4 py-2">
                              </div>
                            {% else %}
                              <input type="number" name="donation" class="form-control" min="1" disabled>
                              <div class='d-flex justify-content-end me-2 '>
                                <input type="submit" name="submit-donation" value="Donate" class="btn btn-primary mt-2 px-5 py-2">
                              </div>
                            {% endif %}
                          </form>
                      </div>
                  </div>
              </div>
              <div class="col-md-12 mt-3">
                <div class="card">
                  <div class="card-body">
                    <h3> Rate Project </h3>
                    <form method="post" class="form-group">
                      {% csrf_token %}
                      {{ratingForm}}
                      <div class='d-flex justify-content-end me-2 '>
                      <input type="submit" name="submit-rating" value="Submit Rating" class="btn btn-primary mt-2 px-3 py-2">
                      </div>
                    </form>
                  </div>
              </div>
              <div class="col-md-12 mt-3">
                <div class="card">
                  <div class="card-body">
                      <h5 class="card-title">Actions</h5>
                      <a href='{%url "reportProject" id=currentProject.id%}'><button class='btn btn-danger'>Report Project</button></a>
                      <a href='{%url "deleteProject" id=currentProject.id%}'><button class='btn btn-danger'>Delete Project</button></a>
                  </div>
              </div>
          </div>
      </div>
  </div>
</div>


<!-- Project Updates Section -->
<div class="container mt-4">
  <h2>Project Updates</h2>
  <div class="card">
      <div class="card-body">
          <h5 class="card-title">Update #1</h5>
          <p class="card-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
      </div>
  </div>
  <div class="card mt-2">
      <div class="card-body">
          <h5 class="card-title">Update #2</h5>
          <p class="card-text">Sed euismod, libero vel lacinia tincidunt, nisl neque convallis.</p>
      </div>
  </div>
</div>

<!-- Comments Section -->
<div class="container mt-4">
  <h2>Comments</h2>
  <form>
      <div class="form-group">
          <textarea class="form-control" rows="3" placeholder="Add a comment"></textarea>
      </div>
      <button type="submit" class="btn btn-primary">Submit Comment</button>
  </form>
  <div class="media mt-3">
      <img src="user-avatar.jpg" class="mr-3" alt="User Avatar">
      <div class="media-body">
          <h5 class="mt-0">Commenter's Name</h5>
          Comment text goes here. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
      </div>
  </div>
</div>





{%endblock%}
